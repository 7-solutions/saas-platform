"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[887],{9887:function(e,t,r){r.d(t,{PH:function(){return g},Um:function(){return f},kh:function(){return y},_f:function(){return i},gF:function(){return P},QA:function(){return w},Di:function(){return D},an:function(){return I},U$:function(){return A}});class s{setupGlobalErrorHandlers(){window.addEventListener("unhandledrejection",e=>{var t;this.logError({type:"client_error",message:"Unhandled Promise Rejection: ".concat(e.reason),stack:null===(t=e.reason)||void 0===t?void 0:t.stack,additionalData:{reason:e.reason,promise:e.promise}})}),window.addEventListener("error",e=>{var t;this.logError({type:"client_error",message:e.message,stack:null===(t=e.error)||void 0===t?void 0:t.stack,additionalData:{filename:e.filename,lineno:e.lineno,colno:e.colno}})})}generateId(){return"".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9))}getCurrentUrl(){return window.location.href}getUserAgent(){return navigator.userAgent}getSessionId(){let e=sessionStorage.getItem("error_session_id");return e||(e=this.generateId(),sessionStorage.setItem("error_session_id",e)),e}getUserId(){try{let e=localStorage.getItem("auth_user");if(e){let t=JSON.parse(e);return t.id||t.email}}catch(e){}}logError(e){let t={id:this.generateId(),type:e.type||"client_error",message:e.message||"Unknown error",stack:e.stack,url:e.url||this.getCurrentUrl(),userAgent:e.userAgent||this.getUserAgent(),timestamp:e.timestamp||new Date().toISOString(),userId:e.userId||this.getUserId(),sessionId:e.sessionId||this.getSessionId(),additionalData:e.additionalData};this.config.enableConsoleLog&&console.error("Error logged:",t),this.errorQueue.push(t),this.config.enableLocalStorage&&this.saveQueuedErrors(),this.errorQueue.length>=this.config.batchSize&&this.flush()}logApiError(e,t,r){this.logError({type:"api_error",message:e.message||"API request failed",additionalData:{url:t,method:r,status:e.status,code:e.code,details:e.details}})}logNetworkError(e,t){this.logError({type:"network_error",message:e.message||"Network request failed",additionalData:{url:t,networkError:!0}})}logValidationError(e,t){this.logError({type:"validation_error",message:"Validation failed",additionalData:{context:t,validationErrors:e}})}async flush(){if(0===this.errorQueue.length)return;let e=this.errorQueue.splice(0,this.config.batchSize);try{let t=await fetch(this.config.apiUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({errors:e})});if(!t.ok)throw Error("HTTP ".concat(t.status,": ").concat(t.statusText));e.forEach(e=>{this.retryCount.delete(e.id)}),this.config.enableLocalStorage&&this.saveQueuedErrors()}catch(t){e.forEach(e=>{let t=this.retryCount.get(e.id)||0;t<this.config.maxRetries?(this.errorQueue.unshift(e),this.retryCount.set(e.id,t+1)):(console.error("Failed to send error after max retries:",e),this.retryCount.delete(e.id))}),setTimeout(()=>{this.flush()},this.config.retryDelay*Math.pow(2,Math.min(3,this.retryCount.size)))}}startPeriodicFlush(){this.flushTimer=setInterval(()=>{this.flush()},this.config.flushInterval)}stopPeriodicFlush(){this.flushTimer&&(clearInterval(this.flushTimer),this.flushTimer=null)}saveQueuedErrors(){try{localStorage.setItem("error_queue",JSON.stringify(this.errorQueue))}catch(e){console.error("Failed to save error queue to localStorage:",e)}}loadQueuedErrors(){try{let e=localStorage.getItem("error_queue");e&&(this.errorQueue=JSON.parse(e))}catch(e){console.error("Failed to load error queue from localStorage:",e),this.errorQueue=[]}}getQueuedErrors(){return[...this.errorQueue]}clearQueue(){this.errorQueue=[],this.retryCount.clear(),this.config.enableLocalStorage&&localStorage.removeItem("error_queue")}destroy(){this.stopPeriodicFlush(),this.flush(),this.clearQueue()}constructor(e={}){this.errorQueue=[],this.flushTimer=null,this.retryCount=new Map,this.config={apiUrl:"/api/v1/errors/report",maxRetries:3,retryDelay:1e3,batchSize:10,flushInterval:3e4,enableLocalStorage:!0,enableConsoleLog:!1,...e},this.startPeriodicFlush(),this.loadQueuedErrors(),this.setupGlobalErrorHandlers()}}let a=null;function i(e){return a&&a.destroy(),a=new s(e)}function o(){return a||(a=new s),a}function n(e,t,r){o().logApiError(e,t,r)}(l=h||(h={})).UNSPECIFIED="USER_ROLE_UNSPECIFIED",l.ADMIN="USER_ROLE_ADMIN",l.EDITOR="USER_ROLE_EDITOR",(c=d||(d={})).UNSPECIFIED="PAGE_STATUS_UNSPECIFIED",c.DRAFT="PAGE_STATUS_DRAFT",c.PUBLISHED="PAGE_STATUS_PUBLISHED",c.ARCHIVED="PAGE_STATUS_ARCHIVED",(u=g||(g={})).UNSPECIFIED="CONTACT_STATUS_UNSPECIFIED",u.NEW="CONTACT_STATUS_NEW",u.READ="CONTACT_STATUS_READ",u.REPLIED="CONTACT_STATUS_REPLIED",u.SPAM="CONTACT_STATUS_SPAM";var l,c,u,h,d,g,p=r(2608);class m{setTokens(e,t){this.accessToken=e,this.refreshToken=t}clearTokens(){this.accessToken=null,this.refreshToken=null,this.refreshPromise=null}async refreshAccessToken(){if(!this.refreshToken)throw Error("No refresh token available");if(this.refreshPromise)return this.refreshPromise;this.refreshPromise=this.performTokenRefresh();try{return await this.refreshPromise}finally{this.refreshPromise=null}}async performTokenRefresh(){var e,t;let r=await fetch("".concat(this.baseUrl,"/api/v1/auth/refresh"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh_token:this.refreshToken})});if(!r.ok)throw this.clearTokens(),null===(t=this.onAuthError)||void 0===t||t.call(this),Error("Failed to refresh token");let s=await r.json();return this.setTokens(s.access_token,s.refresh_token),null===(e=this.onTokenRefresh)||void 0===e||e.call(this,s),s.access_token}async makeRequest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.makeRequestWithRetry(e,t,0)}async makeRequestWithRetry(e,t,r){var s,a,i,l,c;let u="".concat(this.baseUrl).concat(e),h=t.method||"GET",d={"Content-Type":"application/json",...t.headers||{}};this.accessToken&&(d.Authorization="Bearer ".concat(this.accessToken));try{let o={...t,headers:d};null===(s=this.onRequestStart)||void 0===s||s.call(this,u,o);let c=await fetch(u,o);if(null===(a=this.onRequestEnd)||void 0===a||a.call(this,u,c),401===c.status&&this.refreshToken&&"/api/v1/auth/refresh"!==e)try{await this.refreshAccessToken(),d.Authorization="Bearer ".concat(this.accessToken),c=await fetch(u,{...t,headers:d})}catch(t){let e=await this.handleErrorResponse(c);return e.error&&(n(e.error,u,h),null===(i=this.onError)||void 0===i||i.call(this,e.error,u)),e}if(!c.ok&&this.shouldRetry(c.status,r)){let s=this.calculateRetryDelay(r);return await this.sleep(s),this.makeRequestWithRetry(e,t,r+1)}if(!c.ok){let e=await this.handleErrorResponse(c);return e.error&&(n(e.error,u,h),null===(l=this.onError)||void 0===l||l.call(this,e.error,u)),e}if(204===c.status||"0"===c.headers.get("content-length"))return{data:{}};return{data:await c.json()}}catch(a){if(this.shouldRetry(0,r)){let s=this.calculateRetryDelay(r);return await this.sleep(s),this.makeRequestWithRetry(e,t,r+1)}let s={code:"NETWORK_ERROR",message:a instanceof Error?a.message:"Network request failed"};return o().logNetworkError(a,u),null===(c=this.onError)||void 0===c||c.call(this,s,u),{error:s}}}shouldRetry(e,t){return!(t>=this.retryConfig.maxRetries)&&(0===e||this.retryConfig.retryableStatusCodes.includes(e))}calculateRetryDelay(e){let t=this.retryConfig.retryDelay;return this.retryConfig.exponentialBackoff?t*Math.pow(2,e)+1e3*Math.random():t}sleep(e){return new Promise(t=>setTimeout(t,e))}async handleErrorResponse(e){try{let t=await e.json();return{error:{code:t.code||"UNKNOWN_ERROR",message:t.message||"HTTP ".concat(e.status,": ").concat(e.statusText),details:t.details}}}catch(t){return{error:{code:"HTTP_ERROR",message:"HTTP ".concat(e.status,": ").concat(e.statusText)}}}}async login(e){let t=await this.makeRequest("/api/v1/auth/login",{method:"POST",body:JSON.stringify(e)});return t.data&&this.setTokens(t.data.access_token,t.data.refresh_token),t}async validateToken(e){return this.makeRequest("/api/v1/auth/validate",{method:"POST",body:JSON.stringify(e)})}async logout(e){let t=await this.makeRequest("/api/v1/auth/logout",{method:"POST",body:JSON.stringify(e)});return this.clearTokens(),t}async get(e,t){let r=t?"".concat(e,"?").concat(new URLSearchParams(t)):e;return this.makeRequest(r,{method:"GET"})}async post(e,t){return this.makeRequest(e,{method:"POST",body:t?JSON.stringify(t):void 0})}async put(e,t){return this.makeRequest(e,{method:"PUT",body:t?JSON.stringify(t):void 0})}async delete(e){return this.makeRequest(e,{method:"DELETE"})}async uploadFile(e,t,r){let s=new FormData;s.append("file",t),r&&Object.entries(r).forEach(e=>{let[t,r]=e;s.append(t,r)});let a={};this.accessToken&&(a.Authorization="Bearer ".concat(this.accessToken));try{let t=await fetch("".concat(this.baseUrl).concat(e),{method:"POST",headers:a,body:s});if(401===t.status&&this.refreshToken)try{await this.refreshAccessToken(),a.Authorization="Bearer ".concat(this.accessToken),t=await fetch("".concat(this.baseUrl).concat(e),{method:"POST",headers:a,body:s})}catch(e){return this.handleErrorResponse(t)}if(!t.ok)return this.handleErrorResponse(t);return{data:await t.json()}}catch(e){return{error:{code:"NETWORK_ERROR",message:e instanceof Error?e.message:"File upload failed"}}}}isAuthenticated(){return null!==this.accessToken}getAccessToken(){return this.accessToken}constructor(e){this.accessToken=null,this.refreshToken=null,this.refreshPromise=null,this.baseUrl=e.baseUrl.replace(/\/$/,""),this.onTokenRefresh=e.onTokenRefresh,this.onAuthError=e.onAuthError,this.onRequestStart=e.onRequestStart,this.onRequestEnd=e.onRequestEnd,this.onError=e.onError,this.retryConfig={maxRetries:3,retryDelay:1e3,retryableStatusCodes:[408,429,500,502,503,504],exponentialBackoff:!0,...e.retryConfig}}}function f(e){return new m(e)}let y={baseUrl:p.env.NEXT_PUBLIC_API_URL||"http://localhost:8080",onTokenRefresh:e=>{localStorage.setItem("access_token",e.access_token),localStorage.setItem("refresh_token",e.refresh_token)},onAuthError:()=>{localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token")}};var T=r(2383),k=r(4982),_=r(6442);class E{async createPage(e){return this.client.post("/api/v1/pages",e)}async getPage(e){return this.client.get("/api/v1/pages/".concat(e.id))}async updatePage(e){let{id:t,...r}=e;return this.client.put("/api/v1/pages/".concat(t),r)}async deletePage(e){return this.client.delete("/api/v1/pages/".concat(e.id))}async listPages(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={};return e.page_size&&(t.page_size=e.page_size.toString()),e.page_token&&(t.page_token=e.page_token),e.status&&(t.status=e.status),e.search&&(t.search=e.search),this.client.get("/api/v1/pages",t)}async createBlogPost(e){return this.client.post("/api/v1/blog",e)}async getBlogPost(e){return this.client.get("/api/v1/blog/".concat(e.id))}async updateBlogPost(e){let{id:t,...r}=e;return this.client.put("/api/v1/blog/".concat(t),r)}async deleteBlogPost(e){return this.client.delete("/api/v1/blog/".concat(e.id))}async listBlogPosts(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={};return e.page_size&&(t.page_size=e.page_size.toString()),e.page_token&&(t.page_token=e.page_token),e.status&&(t.status=e.status),e.category&&(t.category=e.category),e.tag&&(t.tag=e.tag),e.author&&(t.author=e.author),this.client.get("/api/v1/blog",t)}async searchBlogPosts(e){let t={query:e.query};return e.page_size&&(t.page_size=e.page_size.toString()),e.page_token&&(t.page_token=e.page_token),e.category&&(t.category=e.category),e.tag&&(t.tag=e.tag),this.client.get("/api/v1/blog/search",t)}async getBlogCategories(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0],this.client.get("/api/v1/blog/categories")}async getBlogTags(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0],this.client.get("/api/v1/blog/tags")}async getRSSFeed(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0],this.client.get("/api/v1/blog/rss")}constructor(e){this.client=e}}class S{async submitContactForm(e){return this.client.post("/api/v1/contact",e)}async listContactSubmissions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={};return e.page_size&&(t.page_size=e.page_size.toString()),e.page_token&&(t.page_token=e.page_token),e.status&&(t.status=e.status),e.search&&(t.search=e.search),this.client.get("/api/v1/contact/submissions",t)}async getContactSubmission(e){return this.client.get("/api/v1/contact/submissions/".concat(e.id))}async markContactSubmissionAsRead(e){return this.client.put("/api/v1/contact/submissions/".concat(e.id,"/read"),{})}async deleteContactSubmission(e){return this.client.delete("/api/v1/contact/submissions/".concat(e.id))}constructor(e){this.client=e}}class v{async uploadFile(e,t){if(e instanceof File){let r={};return t&&(r.alt_text=t),this.client.uploadFile("/api/v1/media/upload",e,r)}{let t=new File([e.content],e.filename,{type:e.mime_type}),r={};return e.alt_text&&(r.alt_text=e.alt_text),this.client.uploadFile("/api/v1/media/upload",t,r)}}async getFile(e){return this.client.get("/api/v1/media/".concat(e.id))}async deleteFile(e){return this.client.delete("/api/v1/media/".concat(e.id))}async listFiles(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={};return e.page_size&&(t.page_size=e.page_size.toString()),e.page_token&&(t.page_token=e.page_token),e.mime_type_filter&&(t.mime_type_filter=e.mime_type_filter),e.search&&(t.search=e.search),this.client.get("/api/v1/media",t)}async updateFile(e){let{id:t,...r}=e;return this.client.put("/api/v1/media/".concat(t),r)}constructor(e){this.client=e}}let R={auth:{user:["auth","user"]},pages:{all:["pages"],lists:()=>[...R.pages.all,"list"],list:e=>[...R.pages.lists(),e],details:()=>[...R.pages.all,"detail"],detail:e=>[...R.pages.details(),e]},media:{all:["media"],lists:()=>[...R.media.all,"list"],list:e=>[...R.media.lists(),e],details:()=>[...R.media.all,"detail"],detail:e=>[...R.media.details(),e]},contact:{all:["contact"],submissions:()=>[...R.contact.all,"submissions"],submissionsList:e=>[...R.contact.submissions(),e],submissionDetails:()=>[...R.contact.all,"submission"],submissionDetail:e=>[...R.contact.submissionDetails(),e]}},b=null;function P(e){new E(e),b=new S(e),new v(e)}function C(){if(!b)throw Error("Contact service not initialized. Call setApiClient() first.");return b}function A(e){return(0,T.D)({mutationFn:async e=>C().submitContactForm(e),...e})}function w(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return(0,k.a)({queryKey:R.contact.submissionsList(e),queryFn:async()=>C().listContactSubmissions(e),...t})}function I(e){let t=(0,_.NL)();return(0,T.D)({mutationFn:async e=>C().markContactSubmissionAsRead({id:e}),onSuccess:(e,r)=>{t.invalidateQueries({queryKey:R.contact.submissionDetail(r)}),t.invalidateQueries({queryKey:R.contact.submissions()})},...e})}function D(e){let t=(0,_.NL)();return(0,T.D)({mutationFn:async e=>C().deleteContactSubmission({id:e}),onSuccess:(e,r)=>{t.removeQueries({queryKey:R.contact.submissionDetail(r)}),t.invalidateQueries({queryKey:R.contact.submissions()})},...e})}r(2073),r(1375)}}]);