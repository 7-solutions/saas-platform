(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[57],{4814:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>x});var s=t(2455),r=t(1439),l=t(8443),o=t(2835),i=t(1593),n=t(3745),d=t(5421),c=t(5283);function x(e){let{params:a}=e,t=(0,l.useRouter)(),[x,m]=(0,r.useState)(null),[u,p]=(0,r.useState)(!1),[g,h]=(0,r.useState)(!1),[y,f]=(0,r.useState)(null),[w,b]=(0,r.useState)(!1),[j,v]=(0,r.useState)(!0),[N,k]=(0,r.useState)(null),P=(0,d.dL)(),E=(0,d.wR)();(0,r.useEffect)(()=>{P&&(async()=>{try{v(!0);let e=await P.getPage({id:a.id});if(e.error)throw Error(e.error.message);if(e.data)m(e.data);else throw Error("Page not found")}catch(e){console.error("Failed to load page:",e),k(e.message||"Failed to load page")}finally{v(!1)}})()},[a.id,P]);let _=async e=>{if(x&&P)try{b(!0);let a={id:x.id,title:e.title,slug:e.slug,content:{blocks:[{type:"html",data:{content:e.content}}]},meta:{title:e.meta.title,description:e.meta.description,keywords:e.meta.keywords||[]},status:"published"===e.status?d._g.PUBLISHED:d._g.DRAFT},t=await P.updatePage(a);if(t.error)throw Error(t.error.message);t.data&&m(t.data),alert("Page saved successfully!")}catch(e){console.error("Failed to save page:",e),alert("Failed to save page. Please try again.")}finally{b(!1)}},S=async(e,a)=>{if(!E)throw Error("Media API not available");try{var t;let s=await e.arrayBuffer(),r=new Uint8Array(s),l=await E.uploadFile({content:r,filename:e.name,mime_type:e.type,alt_text:a});if(l.error)throw Error(l.error.message);return(null==(t=l.data)?void 0:t.url)||""}catch(e){throw console.error("Failed to upload image:",e),e}};return j?(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,s.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(c.A,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-gray-400"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Loading page..."})]})})}):N?(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h1",{className:"text-2xl font-semibold text-gray-900 mb-4",children:"Error"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:N}),(0,s.jsx)("button",{onClick:()=>t.push("/dashboard/pages"),className:"text-blue-600 hover:text-blue-800",children:"← Back to Pages"})]})}):x?(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,s.jsx)(o.r,{page:x,onSave:_,onPreview:e=>{f(e),p(!0)},onImageUpload:S,isLoading:w}),y&&(0,s.jsx)(i.u,{data:y,isOpen:u,onClose:()=>p(!1)}),(0,s.jsx)(n.Q,{isOpen:g,onClose:()=>h(!1),onUpload:S})]}):(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h1",{className:"text-2xl font-semibold text-gray-900 mb-4",children:"Page Not Found"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:"The page you're looking for doesn't exist."}),(0,s.jsx)("button",{onClick:()=>t.push("/dashboard/pages"),className:"text-blue-600 hover:text-blue-800",children:"← Back to Pages"})]})})}},7515:(e,a,t)=>{Promise.resolve().then(t.bind(t,4814))}},e=>{e.O(0,[80,980,753,96,76,504,358],()=>e(e.s=7515)),_N_E=e.O()}]);